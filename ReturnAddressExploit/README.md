## ReturnAddressExploit

This program is really simple. It asks you for your name and then greets you.
But it can also be used to demonstrate a return address exploit.

### How does it work?

The name of the user is read on the stack using `gets`. This function does not
check for a bufferoverflow. That means we can overwrite the return address of
the function greeting you.

Lets take a closer look a the code:

```
f1:
    push        rbp
    mov         rbp, rsp
    sub         rsp, 16    ; Reserve 16 bytes on the stack for the name

    mov         rdi, out_str1
    call        printf

    mov         rdi, rsp
    call        gets
```

In the function f1 that reads your name and greets you, the first action is
pushing the base-pointer on the stack and then reserving 16 bytes for your
name. That gives us the following stack layout:

```
         High address

       | Return address (8 bytes)   |
       |----------------------------|
       | Old base-pointer (8 bytes) |
       |----------------------------|
rbp -> | 16th byte of the name      |
       {                            }
rsp -> | First byte of the name     |        

         Low address
```

That means to overwrtie the return address the we need to enter 20 bytes and
the our new return address.

Our new return address shall be the function `f2` of this program. This function
just prints "exp0ited".

The address of this program can be obtained using
`objdump -D returnaddressexploit`:

```
0000000000400580 <f2>:
  400580:	55                   	push   %rbp
  400581:	48 89 e5             	mov    %rsp,%rbp
```

We just need the least significant 3 bytes of the address. With that we can
build our exploit. To test it run `python3 exploit.py | returnaddressexploit`
